{% extends "base.html" %}

{% block title %}Ai 영어친구 - 학습 리포트{% endblock %}

{% block head %}
<link href="{{ url_for('static', filename='css/myreport.css') }}" rel="stylesheet">
{% endblock %}

{% block content %}
<div id="report-container" style="overflow-y: auto;">
    <div id="title_sub"><h2>|| {{ user.nickName | default('Unknown User') }}의 학습 리포트</h2></div>
    <div class="myreport-score">
        <div class="user-info">
            <h2>User Information</h2>
            <table id="userTable">
                <tr>
                    <td>아이디</td>
                    <td>{{ user.id | default('No ID') }}</td>
                </tr>
                <tr>
                    <td>닉네임</td>
                    <td>{{ user.nickName | default('No Nickname') }}</td>
                </tr>
                <tr>
                    <td>출생년도</td>
                    <td>{{ user.birth_date.year | default('No Birthdate') }}</td>
                </tr>
                <tr>
                    <td>사용자 분류</td>
                    <td>{{ user.role | default('No Role') }}</td>
                </tr>
            </table>
        </div>
        <div class="user-character">
            <h4>현재 레벨: STARTER</h4>
            <img src="{{ url_for('static', filename='images/characters/starter/ch00_1.gif') }}" id="mycharacter" alt="캐릭터 이미지">
        </div>
    </div>

    <!-- Daily Report Section -->
    <div class="sub">
        <div class="table-title">일간평가</div>
     </div>
    <div class="myreport-score">
        <div class="chart-container">
            <canvas id="dailyChart"></canvas>
        </div>
        <div class="table-container">
            <span class="table-title">오늘의 평가현황</span>
            <table id="dailyTable">
                <thead>
                    <tr>
                        <th>평가항목</th>
                        <th>점수</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Table rows added dynamically -->
                </tbody>
            </table>
            <!-- 도넛 색상 설명 테이블 -->
            <table class="legend-table">
                <tbody>
                    <tr>
                        <td><span class="color-box" style="background-color: #FF6384;"></span></td>
                        <td>Fluency</td>
                        <td><span class="color-box" style="background-color: #36A2EB;"></span></td>
                        <td>Grammar</td>
                        <td><span class="color-box" style="background-color: #FFCE56;"></span></td>
                        <td>Vocabulary</td>
                    </tr>
                    <tr>
                        <td><span class="color-box" style="background-color: #4BC0C0;"></span></td>
                        <td>Content</td>
                        <td><span class="color-box" style="background-color: #9966FF;"></span></td>
                        <td>Pronunciation</td>
                        <td></span></td>
                        <td></td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
    
    <!-- Weekly Report Section -->
    <div class="sub">
        <div class="table-title">
            주간평가
            <div id="weekly-selector">
                <input type="date" id="dateSelector">
            </div>
        </div>

    </div>
    <div class="myreport-score">            
                <div class="chart-container">
                    <canvas id="weeklyChart"></canvas>
                </div>
                <div class="table-container">
                    <span class="table-title">주간 평가현황</span>
                    <table id="weeklyTable">
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Flu.</th>
                                <th>Gra</th>
                                <th>Voc.</th>
                                <th>Con.</th>
                                <th>Pro.</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Table rows added dynamically -->
                        </tbody>
                    </table>
                </div>
            
    </div>
    
</div>

{% endblock %}

{% block scripts %}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="{{ url_for('static', filename='js/myreport.js') }}"></script>
{% endblock %}
