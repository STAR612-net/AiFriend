2024-08-28 17:36:26,642 ERROR: Exception on /ai/update_user [GET] [in /home/star/anaconda3/envs/py390_project/lib/python3.9/site-packages/flask/app.py:838]
Traceback (most recent call last):
  File "/home/star/anaconda3/envs/py390_project/lib/python3.9/site-packages/flask/app.py", line 1473, in wsgi_app
    response = self.full_dispatch_request()
  File "/home/star/anaconda3/envs/py390_project/lib/python3.9/site-packages/flask/app.py", line 882, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/home/star/anaconda3/envs/py390_project/lib/python3.9/site-packages/flask_cors/extension.py", line 161, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "/home/star/anaconda3/envs/py390_project/lib/python3.9/site-packages/flask/app.py", line 880, in full_dispatch_request
    rv = self.dispatch_request()
  File "/home/star/anaconda3/envs/py390_project/lib/python3.9/site-packages/flask/app.py", line 865, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "/home/star/anaconda3/envs/py390_project/lib/python3.9/site-packages/flask_login/utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "/home/star/project/AiFriend/app/routes.py", line 67, in update_user
    form = RegistrationForm(obj=current_user)  # Assuming you're using WTForms
NameError: name 'RegistrationForm' is not defined
2024-08-29 02:44:15,724 INFO: App startup [in /home/star/project/AiFriend/app/__init__.py:47]
2024-08-29 11:14:26,832 INFO: User logged in: abc1234 [in /home/star/project/AiFriend/app/auth/routes.py:72]
2024-08-29 11:16:54,275 INFO: User logged in: user1 [in /home/star/project/AiFriend/app/auth/routes.py:72]
2024-08-29 11:26:02,266 WARNING: Failed login attempt for user user3 [in /home/star/project/AiFriend/app/auth/routes.py:76]
2024-08-29 11:26:10,149 WARNING: Failed login attempt for user user3 [in /home/star/project/AiFriend/app/auth/routes.py:76]
2024-08-29 11:26:41,211 INFO: User logged in: abc1234 [in /home/star/project/AiFriend/app/auth/routes.py:72]
2024-08-29 11:28:34,168 INFO: User logged in: user2 [in /home/star/project/AiFriend/app/auth/routes.py:72]
2024-08-29 11:29:15,125 INFO: User logged in: abc1234 [in /home/star/project/AiFriend/app/auth/routes.py:72]
2024-08-29 11:30:48,709 ERROR: Exception on /ai/update_user [GET] [in /home/star/anaconda3/envs/py390_project/lib/python3.9/site-packages/flask/app.py:838]
Traceback (most recent call last):
  File "/home/star/anaconda3/envs/py390_project/lib/python3.9/site-packages/flask/app.py", line 1473, in wsgi_app
    response = self.full_dispatch_request()
  File "/home/star/anaconda3/envs/py390_project/lib/python3.9/site-packages/flask/app.py", line 882, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/home/star/anaconda3/envs/py390_project/lib/python3.9/site-packages/flask_cors/extension.py", line 161, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "/home/star/anaconda3/envs/py390_project/lib/python3.9/site-packages/flask/app.py", line 880, in full_dispatch_request
    rv = self.dispatch_request()
  File "/home/star/anaconda3/envs/py390_project/lib/python3.9/site-packages/flask/app.py", line 865, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "/home/star/anaconda3/envs/py390_project/lib/python3.9/site-packages/flask_login/utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
  File "/home/star/project/AiFriend/app/routes.py", line 67, in update_user
    form = RegistrationForm(obj=current_user)  # Assuming you're using WTForms
NameError: name 'RegistrationForm' is not defined
2024-08-29 11:43:45,732 ERROR: Failed to save AI test result: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`aifriend`.`ai_chat_test`, CONSTRAINT `ai_chat_test_ibfk_1` FOREIGN KEY (`topic_id`) REFERENCES `topic` (`topic_id`))')
[SQL: INSERT INTO ai_chat_test (`chatTest_id`, user_id, `chatDate`, topic_id, fluency, grammar, vocabulary, content, `simpleEvaluation`) VALUES (%(chatTest_id)s, %(user_id)s, %(chatDate)s, %(topic_id)s, %(fluency)s, %(grammar)s, %(vocabulary)s, %(content)s, %(simpleEvaluation)s)]
[parameters: {'chatTest_id': 'b5ae525b-55ad-4e77-afa3-9383af783a5d', 'user_id': '6856f521-3d73-4c18-a8c8-96185a500691', 'chatDate': datetime.datetime(2024, 8, 29, 2, 43, 45, 714751), 'topic_id': '8196329c-5a7d-4371-aa96-a2a3ef6f52a3', 'fluency': 6, 'grammar': 7, 'vocabulary': 8, 'content': 5, 'simpleEvaluation': "You're doing great."}]
(Background on this error at: https://sqlalche.me/e/20/gkpj) [in /home/star/project/AiFriend/app/ai_chat.py:82]
2024-08-29 11:43:45,733 ERROR: Failed to save the test result to the database, but proceeding to send the response. [in /home/star/project/AiFriend/app/ai_chat.py:138]
2024-08-29 21:23:37,711 INFO: User logged in: abc1234 [in /home/star/project/AiFriend/app/auth/routes.py:72]
2024-08-29 21:27:44,106 ERROR: Failed to save AI test result: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`aifriend`.`ai_chat_test`, CONSTRAINT `ai_chat_test_ibfk_1` FOREIGN KEY (`topic_id`) REFERENCES `topic` (`topic_id`))')
[SQL: INSERT INTO ai_chat_test (`chatTest_id`, user_id, `chatDate`, topic_id, fluency, grammar, vocabulary, content, `simpleEvaluation`) VALUES (%(chatTest_id)s, %(user_id)s, %(chatDate)s, %(topic_id)s, %(fluency)s, %(grammar)s, %(vocabulary)s, %(content)s, %(simpleEvaluation)s)]
[parameters: {'chatTest_id': '1796bf3e-0d07-4490-b17f-d16ed930308b', 'user_id': '6856f521-3d73-4c18-a8c8-96185a500691', 'chatDate': datetime.datetime(2024, 8, 29, 12, 27, 44, 95689), 'topic_id': '8196329c-5a7d-4371-aa96-a2a3ef6f52a3', 'fluency': 7, 'grammar': 8, 'vocabulary': 6, 'content': 5, 'simpleEvaluation': "You're doing great."}]
(Background on this error at: https://sqlalche.me/e/20/gkpj) [in /home/star/project/AiFriend/app/ai_chat.py:82]
2024-08-29 21:27:44,106 ERROR: Failed to save the test result to the database, but proceeding to send the response. [in /home/star/project/AiFriend/app/ai_chat.py:138]
2024-08-30 09:13:21,474 ERROR: Failed to save AI test result: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`aifriend`.`ai_chat_test`, CONSTRAINT `ai_chat_test_ibfk_1` FOREIGN KEY (`topic_id`) REFERENCES `topic` (`topic_id`))')
[SQL: INSERT INTO ai_chat_test (`chatTest_id`, user_id, `chatDate`, topic_id, fluency, grammar, vocabulary, content, `simpleEvaluation`) VALUES (%(chatTest_id)s, %(user_id)s, %(chatDate)s, %(topic_id)s, %(fluency)s, %(grammar)s, %(vocabulary)s, %(content)s, %(simpleEvaluation)s)]
[parameters: {'chatTest_id': '33b1161e-7fde-4cca-90b7-985c0103d19d', 'user_id': '6856f521-3d73-4c18-a8c8-96185a500691', 'chatDate': datetime.datetime(2024, 8, 30, 0, 13, 21, 462056), 'topic_id': '8196329c-5a7d-4371-aa96-a2a3ef6f52a3', 'fluency': 6, 'grammar': 7, 'vocabulary': 5, 'content': 8, 'simpleEvaluation': "You're doing great."}]
(Background on this error at: https://sqlalche.me/e/20/gkpj) [in /home/star/project/AiFriend/app/ai_chat.py:82]
2024-08-30 09:13:21,474 ERROR: Failed to save the test result to the database, but proceeding to send the response. [in /home/star/project/AiFriend/app/ai_chat.py:138]
